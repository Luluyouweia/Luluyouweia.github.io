<!doctype html>
<html>

<head>
    <meta charset="UTF-8">
    <title>英语书写</title>
    <meta name="viewport" id="viewport" content="width=device-width, initial-scale=1">
</head>

<body>
    <div style="text-align: center;font-size: 4vh;font-weight: 200;color: #08f;">英语书写单元格设计</div>
    <br />
    <div id="hidden" style="color: red;">网页正在加载中...</div>
    <h3>预览</h3>
    <svg id="svg" width="2880" height="90" xmlns="http://www.w3.org/2000/svg">
        <defs>
            <g fill="none" stroke="black" id="unit">
                <line x1="0" y1="0" x2="30" y2="0" stroke-width="4" id="svg_9" stroke-dasharray="3" />
                <line stroke-dasharray="3" x1="0" y1="30" x2="30" y2="30" stroke-width="2" id="svg_8" />
                <line id="svg_7" stroke-width="2" y2="60" x2="30" y1="60" x1="0" />
                <line id="svg_6" stroke-width="1.5" y2="90" x2="0" y1="0" x1="9.5" stroke-dasharray="3" />
                <line x1="0" y1="90" x2="30" y2="90" stroke-width="4" id="svg_5" stroke-dasharray="3" />
            </g>
        </defs>
        <use x="0" y="0" href="#unit"></use>
        <use x="30" y="0" href="#unit"></use>
        <use x="60" y="0" href="#unit"></use>
    </svg>
    <section>
        <h3>调整</h3>
        单行数目
        <input id="count" type="value" value="3">
    </section>
    <br/>
    <h3>注意</h3>
    <div>
        手机设备可能不支持在设备上直接查看下载的svg图像，在计算机办公软件中导入图片即可。
    </div>
    <br>
    <button style="color: #fff;outline: none;border: none;background: #08f;font-size: 3vh;text-align: center;" onclick="downloadSVG()">点击下载</button>
    <script>
    document.getElementById("hidden").style.display="none";
        let inputObj = document.getElementById("count");
        inputObj.addEventListener('input', () => {
            try {
                setCount(inputObj.value)
            } catch (error) {
                //不做任何处理了吧
            }
        })

        function setCount(num) {
            let template = `
            <defs>
            <g fill="none" stroke="black" id="unit">
                <line x1="0" y1="0" x2="30" y2="0" stroke-width="4" id="svg_9" stroke-dasharray="3" />
                <line stroke-dasharray="3" x1="0" y1="30" x2="30" y2="30" stroke-width="2" id="svg_8" />
                <line id="svg_7" stroke-width="2" y2="60" x2="30" y1="60" x1="0" />
                <line id="svg_6" stroke-width="1.5" y2="90" x2="0" y1="0" x1="9.5" stroke-dasharray="3" />
                <line x1="0" y1="90" x2="30" y2="90" stroke-width="4" id="svg_5" stroke-dasharray="3" />
            </g>
            </defs>
         `
            for (let i = 0; i < num; ++i) {
                template += ` <use x="${i*30}" y="0" href="#unit"></use>`
            }
            let result = template;
            document.getElementById("svg").innerHTML = result;
        }

        function downloadSVG() {
            // 1. 获取指定ID的SVG元素
            const id = "svg";
            const svgElement = document.getElementById("svg");
            
            if (!svgElement) {
                console.log(`未找到ID为"${id}"的SVG元素`);
                return;
            }
            
            // 2. 将SVG元素序列化为字符串
            const svgString = new XMLSerializer().serializeToString(svgElement);
            
            // 3. 创建Blob对象和下载链接
            const blob = new Blob([svgString], { type: 'image/svg+xml' });
            const url = URL.createObjectURL(blob);
            
            const downloadLink = document.createElement('a');
            downloadLink.href = url;
            downloadLink.download = `英语书写.svg`;
            
            // 4. 触发下载并清理资源
            document.body.appendChild(downloadLink);
            downloadLink.click();
            document.body.removeChild(downloadLink);
            URL.revokeObjectURL(url);
        }
    </script>
</body>

</html>